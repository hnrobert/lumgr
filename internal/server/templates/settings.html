{{define "title"}}Settings Â· lumgr{{end}}
{{define "content"}}
<div class="grid two">
    <div class="card">
        <h2 style="margin:0 0 8px;">Personal settings</h2>
        <div class="muted">These settings are stored in your home directory.</div>
        <form method="post" action="/settings">
            <label>Default Shell</label>
            <select name="shell">
                {{range .AvailableShells}}
                <option value="{{.}}" {{if eq . $.Shell}}selected{{end}}>{{.}}</option>
                {{end}}
            </select>

            <label>Preferred terminal type (TERM)</label>
            <input name="term" placeholder="xterm-256color" value="{{.Term}}" />

            <label>Login redirect directory (optional)</label>
            <input name="redirect" placeholder="/home/{{.Username}}/example-directory" value="{{.Redirect}}" />

            <div class="row">
                <div>
                    <label>Git user.name</label>
                    <input name="git_name" placeholder="Your Git Name" value="{{.GitName}}" />
                </div>
                <div>
                    <label>Git user.email</label>
                    <input name="git_email" placeholder="name@example.com" value="{{.GitEmail}}" />
                </div>
            </div>

            <label>SSH authorized_keys</label>
            <textarea name="ssh_keys" placeholder="ssh-rsa AAAAB3QB3U7EAr1v... user@example.com
ssh-ed25519 AAAAC3NzAIC3... user2@example.com" spellcheck="false">{{.SSHKeys}}</textarea>


            <div style="display:flex; justify-content:flex-end; margin-top: 14px;">
                <button class="btn primary" type="submit">Save</button>
            </div>
        </form>
    </div>

    <div class="card">
        <h2 style="margin:0 0 8px;">Notice</h2>
        <div class="muted" style="line-height:1.55;">
            {{.LumgrWhatEditsHTML}}
        </div>
    </div>

    <div class="card">
        <h2 style="margin:0 0 8px;">File Permissions</h2>
        <div class="muted" style="margin-bottom: 12px;">Recursively apply chmod to your home (skips .ssh).</div>

        <form method="post" action="{{.PermFormAction}}">
            {{template "perms_table" .}}

            <div style="display:flex; justify-content:flex-end; margin-top: 14px;">
                <button class="btn danger" type="submit">{{.PermSubmitLabel}}</button>
            </div>
        </form>
    </div>

    <div class="card">
        <h2 style="margin:0 0 8px;">Default umask</h2>
        <div class="muted" style="margin-bottom: 12px;">Used when creating new files and directories.</div>

        <form method="post" action="{{.PermUmaskFormAction}}" style="display:flex; gap:8px; align-items:center;">
            <input name="umask" placeholder="022" value="{{.PermUmaskValue}}" style="width:80px;" />
            <button class="btn primary small" type="submit">Save</button>
        </form>
    </div>

    <div class="card">
        <h2 style="margin:0 0 8px;">Change password</h2>
        <div class="muted" style="margin-bottom: 12px;">Update your host Linux account password.</div>
        <form method="post" action="/settings/password">
            <label>Current password</label>
            <input type="password" name="current_password" autocomplete="current-password" required />

            <label>New password</label>
            <input type="password" name="new_password" autocomplete="new-password" required />

            <label>Confirm new password</label>
            <input type="password" name="new_password2" autocomplete="new-password" required />

            <div style="display:flex; justify-content:flex-end; margin-top: 14px;">
                <button class="btn primary" type="submit">Update password</button>
            </div>
        </form>
    </div>

</div>
{{end}}