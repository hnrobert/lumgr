{{define "title"}}Dashboard · lumgr{{end}}
{{define "content"}}

{{if .OSPrettyName}}
<div class="card" style="margin-bottom: 16px;">
    <h2 style="margin:0 0 8px;">Host Information</h2>
    <div style="margin-top: 14px;">
        <div style="padding: 16px; background: var(--bg-darker); border-radius: 8px; border: 1px solid var(--border);">
            <div style="display: grid; gap: 12px;">
                {{if .Hostname}}
                <div>
                    <div class="muted" style="font-size: 13px; margin-bottom: 4px;">Hostname</div>
                    <div style="font-size: 16px; font-weight: 500;">{{.Hostname}}</div>
                </div>
                {{end}}
                <div>
                    <div class="muted" style="font-size: 13px; margin-bottom: 4px;">Operating System</div>
                    <div style="font-size: 16px; font-weight: 500;">{{.OSPrettyName}}</div>
                </div>
                {{if .OSVersion}}
                <div>
                    <div class="muted" style="font-size: 13px; margin-bottom: 4px;">Version</div>
                    <div style="font-size: 16px;">{{.OSVersion}}</div>
                </div>
                {{end}}
            </div>
        </div>
    </div>
</div>
{{end}}

{{if .CurrentMetrics}}
<div class="card" style="margin-bottom: 16px;">
    <h2 style="margin:0 0 8px;">System Resources</h2>
    <div class="grid two" style="margin-top: 12px;">
        <div>
            <div class="muted">CPU usage</div>
            <div style="font-size:22px; font-weight:600; margin-top:4px;">{{printf "%.1f" .CurrentMetrics.CPUUsage}}%
            </div>
        </div>
        <div>
            <div class="muted">Memory</div>
            <div style="font-size:22px; font-weight:600; margin-top:4px;">{{bytes .CurrentMetrics.MemUsed}} / {{bytes
                .CurrentMetrics.MemTotal}}</div>
        </div>
        <div>
            <div class="muted">Disk IO (cumulative)</div>
            <div style="font-size:14px; margin-top:4px;">R: {{bytes .CurrentMetrics.DiskReadBytes}} · W: {{bytes
                .CurrentMetrics.DiskWriteBytes}}</div>
        </div>
        <div>
            <div class="muted">Network (cumulative)</div>
            <div style="font-size:14px; margin-top:4px;">RX: {{bytes .CurrentMetrics.NetworkRxBytes}} · TX: {{bytes
                .CurrentMetrics.NetworkTxBytes}}</div>
        </div>
    </div>
    {{if .CurrentMetrics.Filesystems}}
    <div style="margin-top:12px;">
        <div class="muted" style="margin-bottom:6px;">Filesystems</div>
        <div style="display:flex; flex-direction:column; gap:6px;">
            {{range .CurrentMetrics.Filesystems}}
            <div style="display:flex; justify-content:space-between; gap:8px; font-size:13px;">
                <span><code>{{.MountPoint}}</code></span>
                <span>{{printf "%.1f" .UsePercent}}% ({{bytes .Used}} / {{bytes .Total}})</span>
            </div>
            {{end}}
        </div>
    </div>
    {{end}}
</div>
{{end}}

<div class="grid two rowMatch" style="margin-bottom: 16px;">
    <div class="card">
        <h2 style="margin:0 0 8px;">Quick Actions</h2>
        <div class="muted" style="margin-bottom: 8px;">Signed in as <code>{{.Username}}</code>{{if .Admin}}
            (admin){{end}}.</div>

        <div
            style="display:grid; grid-template-columns:repeat(auto-fit, minmax(180px, 1fr)); gap:10px; margin-top:8px;">
            <a class="btn" href="/settings/shell" style="text-decoration:none;">Shell settings</a>
            <a class="btn" href="/settings/ssh" style="text-decoration:none;">SSH keys &amp; keygen</a>
            <a class="btn" href="/settings/git" style="text-decoration:none;">Git settings</a>
            <a class="btn" href="/settings/filesystem" style="text-decoration:none;">File system</a>
            <a class="btn" href="/settings/security" style="text-decoration:none;">Security / Password</a>

            {{if .Admin}}
            <a class="btn" href="/admin/users" style="text-decoration:none;">Manage users</a>
            <a class="btn" href="/admin/groups" style="text-decoration:none;">Manage groups</a>
            <a class="btn" href="/admin/invites" style="text-decoration:none;">Manage invites</a>
            <a class="btn" href="/admin/lumgr_settings" style="text-decoration:none;">Lumgr settings</a>
            {{end}}
        </div>

    </div>

    <div class="card">
        <h2 style="margin:0 0 8px;">Notice</h2>
        <div class="muted" style="line-height:1.55;">{{.LumgrWhatEditsHTML}}</div>
    </div>
</div>

{{if .Admin}}
<div class="card" style="margin-bottom: 16px;">
    <h2 style="margin:0 0 8px;">System Statistics</h2>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 14px;">
        <div
            style="padding: 20px; background: rgba(122, 162, 255, .08); border-radius: 10px; border: 1px solid rgba(122, 162, 255, .15);">
            <div class="muted" style="font-size: 14px; margin-bottom: 8px;">Total Users</div>
            <div style="font-size: 32px; font-weight: 600;">{{.TotalUsers}}</div>
        </div>
        <div
            style="padding: 20px; background: rgba(61, 220, 151, .08); border-radius: 10px; border: 1px solid rgba(61, 220, 151, .15);">
            <div class="muted" style="font-size: 14px; margin-bottom: 8px;">Administrators</div>
            <div style="font-size: 32px; font-weight: 600;">{{.AdminUsers}}</div>
        </div>
    </div>
</div>
{{end}}

{{if .HomeSize}}
<div class="card">
    <h2 style="margin:0 0 8px;">Storage Usage</h2>
    <div style="display: flex; align-items: center; gap: 20px; margin-top: 14px;">
        <div style="flex: 1;">
            <div class="muted" style="font-size: 14px; margin-bottom: 8px;">Home directory: <code>{{.Username}}</code>
            </div>
            <div style="font-size: 32px; font-weight: 600; color: var(--accent);">{{.HomeSize}}</div>
        </div>
    </div>
</div>
{{end}}

{{end}}